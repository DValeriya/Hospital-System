CREATE OR REPLACE NONEDITIONABLE PROCEDURE Create_User(
	NAME VARCHAR2,
	PASSWORD VARCHAR2,
	PHONENUMBER VARCHAR2,
	BIRTHDATE DATE,
	EMAIL VARCHAR2,
	ROLE NUMBER) AS
	USER_ID NUMBER;
	USER_LOGIN NUMBER;
	BEGIN			
		SELECT OBJECT_ID_SEQ.NEXTVAL INTO USER_ID FROM DUAL;
		SELECT USER_LOGIN_SEQ.NEXTVAL INTO USER_LOGIN FROM DUAL;
		INSERT INTO OBJECTS(OBJECT_ID, PARENT_ID, OBJECT_TYPE_ID, NAME)
			VALUES(USER_ID, NULL, 1, NAME);
		INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, VALUE)
			VALUES(1, USER_ID, USER_LOGIN);
		INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, VALUE)
			VALUES(2, USER_ID, PASSWORD);
		INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, VALUE)
			VALUES(3, USER_ID, NAME);
		INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, VALUE)
			VALUES(4, USER_ID, PHONENUMBER);
		INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, LIST_VALUE_ID)
			VALUES(7, USER_ID, ROLE);
		IF BIRTHDATE IS NOT NULL
			THEN
				INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, DATE_VALUE)
					VALUES(5, USER_ID, BIRTHDATE);
		END IF;
		IF EMAIL IS NOT NULL AND LENGTH(EMAIL) > 0
			THEN
				INSERT INTO ATTRIBUTES(ATTR_ID, OBJECT_ID, VALUE)
					VALUES(6, USER_ID, EMAIL);
		END IF;
		COMMIT;
	END;
	
CREATE OR REPLACE NONEDITIONABLE PROCEDURE Create_DoctorSpec(
	TITLE VARCHAR2) AS
	SPEC_ID NUMBER;
	BEGIN			
		SELECT OBJECT_ID_SEQ.NEXTVAL INTO SPEC_ID FROM DUAL;
		INSERT INTO OBJECTS(OBJECT_ID, PARENT_ID, OBJECT_TYPE_ID, NAME)
			VALUES(SPEC_ID, NULL, 6, TITLE);
		COMMIT;
	END;